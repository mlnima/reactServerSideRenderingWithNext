{"version":3,"file":"static/webpack/static\\development\\pages\\auth\\login.js.5376e866bd015d9458a9.hot-update.js","sources":["webpack:///./components/includes/TopBar/TopBar.js","webpack:///./context/AppContext.js"],"sourcesContent":["import React, { useContext, useEffect } from 'react';\r\nimport Link from \"next/link\";\r\nimport './TopBar.scss';\r\nimport { AppContext } from \"../../../context/AppContext\";\r\nimport { withRouter } from \"next/router\";\r\n\r\nconst TopBar = props => {\r\n    const contextData = useContext(AppContext);\r\n\r\n    if (contextData.userData.username) {\r\n        if (contextData.userData.role === 'administrator') {\r\n            return (\r\n                <div className='TopBar'>\r\n                    <button onClick={ () => contextData.functions.logOutUser() }>Log Out</button>\r\n                    <button onClick={ () => contextData.functions.goToAdminPanel() }>Admin Panel</button>\r\n                </div>\r\n            )\r\n        } else {\r\n            return (\r\n                <div className='TopBar'>\r\n                    <button onClick={ () => contextData.functions.logOutUser() }>Log Out</button>\r\n                </div>\r\n            );\r\n        }\r\n    } else {\r\n        return (\r\n            <div className='TopBar'>\r\n                <Link href='/auth/login'><a>Login</a></Link>\r\n                <span>Or</span>\r\n                <Link href='/auth/register'><a>Register</a></Link>\r\n            </div>\r\n        );\r\n    }\r\n};\r\n\r\nexport default withRouter(TopBar);\r\n","import React, { useEffect, useRef, useState } from 'react';\r\nimport jwtDecode from \"jwt-decode\";\r\nimport jwt from 'jsonwebtoken';\r\nimport axios from \"axios\";\r\nimport {withRouter} from \"next/router\";\r\n\r\nexport const AppContext = React.createContext();\r\n\r\nconst AppProvider = props => {\r\n\r\n    const [ state, dispatchState ] = useState({});\r\n    const [ settings, dispatchSettings ] = useState({\r\n        adminPanelSideBar: false,\r\n        test: false\r\n    });\r\n    const [ userData, dispatchUserData ] = useState({});\r\n    const [ functions, dispatchFunctions ] = useState({\r\n        getAndSetUserInfo: async ()=>{\r\n            if (localStorage.wt){\r\n                await axios.post('/api/v1/users/getUserInfo', { token: localStorage.wt }).then(res=>{\r\n                    dispatchUserData({...userData,...res.data.userData});\r\n                }).then(()=>{\r\n                    props.router.push('/')\r\n                }).catch(err=>{\r\n                    console.log( err);\r\n                })\r\n            }\r\n        },\r\n        logOutUser:()=>{\r\n            localStorage.removeItem('wt');\r\n            dispatchUserData({})\r\n            props.router.push('/')\r\n        },\r\n        goToAdminPanel:()=>{\r\n            props.router.push('/admin')\r\n        }\r\n    });\r\n\r\n    useEffect(()=>{\r\n        functions.getAndSetUserInfo()\r\n    },[ ]);\r\n\r\n\r\n    useEffect(()=>{\r\n        if (userData.username){\r\n            if(props.router.pathname === '/auth/login'||props.router.pathname === '/auth/register'){\r\n                props.router.push('/')\r\n            }\r\n        }\r\n    },[ props.router.pathname]);\r\n\r\n\r\n    return (\r\n        <div>\r\n            <AppContext.Provider\r\n                value={ {\r\n                    state,\r\n                    dispatchState,\r\n                    settings,\r\n                    dispatchSettings,\r\n                    userData,\r\n                    dispatchUserData,\r\n                    functions\r\n                } }>\r\n\r\n                { props.children }\r\n            </AppContext.Provider>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const  AppProviderWithRouter = withRouter(AppProvider);"],"mappings":";;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AAAA;AACA;AAAA;AAAA;AAAA;AAGA;AACA;AACA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AAGA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACnCA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AADA;AAIA;AACA;AAFA;AAHA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAnBA;AARA;AAAA;AACA;AA6BA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AADA;AAeA;AACA;AACA;;;;A","sourceRoot":""}