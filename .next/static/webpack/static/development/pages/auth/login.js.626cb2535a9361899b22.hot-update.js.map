{"version":3,"file":"static/webpack/static\\development\\pages\\auth\\login.js.626cb2535a9361899b22.hot-update.js","sources":["webpack:///./context/AppContext.js","webpack:///./pages/auth/login.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from 'react';\r\nimport jwtDecode from \"jwt-decode\";\r\nimport jwt from 'jsonwebtoken';\r\nimport axios from \"axios\";\r\nimport {withRouter} from \"next/router\";\r\n\r\nexport const AppContext = React.createContext();\r\n\r\nconst AppProvider = props => {\r\n\r\n    const [ state, dispatchState ] = useState({});\r\n    const [ settings, dispatchSettings ] = useState({\r\n        adminPanelSideBar: false,\r\n        test: false\r\n    });\r\n    const [ userData, dispatchUserData ] = useState({});\r\n    const [ functions, dispatchFunctions ] = useState({\r\n        getAndSetUserInfo: async ()=>{\r\n            if (localStorage.wt){\r\n                await axios.post('/api/v1/users/getUserInfo', { token: localStorage.wt }).then(res=>{\r\n                    dispatchUserData({...userData,...res.data.userData});\r\n                }).catch(err=>{\r\n                    console.log( err);\r\n                })\r\n            }\r\n        },\r\n        logOutUser:()=>{\r\n            localStorage.removeItem('wt');\r\n            dispatchUserData({})\r\n            props.router.push('/')\r\n        },\r\n        goToAdminPanel:()=>{\r\n            props.router.push('/admin')\r\n        },\r\n        goToHomePage:()=>{\r\n            props.router.push('/')\r\n        }\r\n    });\r\n\r\n    useEffect(()=>{\r\n        functions.getAndSetUserInfo()\r\n    },[ ]);\r\n\r\n\r\n    useEffect(()=>{\r\n        if (userData.username){\r\n            if(props.router.pathname === '/auth/login'||props.router.pathname === '/auth/register'){\r\n                props.router.push('/')\r\n            }\r\n        }\r\n    },[ props.router.pathname]);\r\n\r\n\r\n    return (\r\n        <div>\r\n            <AppContext.Provider\r\n                value={ {\r\n                    state,\r\n                    dispatchState,\r\n                    settings,\r\n                    dispatchSettings,\r\n                    userData,\r\n                    dispatchUserData,\r\n                    functions\r\n                } }>\r\n\r\n                { props.children }\r\n            </AppContext.Provider>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport const  AppProviderWithRouter = withRouter(AppProvider);","import React, { useState, useRef, useContext, useEffect } from 'react';\r\nimport AppLayout from \"../../components/layouts/AppLayout\";\r\nimport './registerLogin.scss';\r\nimport axios from 'axios'\r\nimport { AppContext } from \"../../context/AppContext\";\r\n\r\nconst Login = props => {\r\n    const contextData = useContext(AppContext);\r\n    const messageLabel = useRef(null);\r\n    const [ state, setState ] = useState({});\r\n    const [ data, setData ] = useState({\r\n        response: undefined,\r\n        type: undefined,\r\n    });\r\n\r\n    const onChangeHandler = e => {\r\n        setState({\r\n            ...state,\r\n            [e.target.name]: e.target.value\r\n        })\r\n    };\r\n    const onSubmitHandler = e => {\r\n        e.preventDefault();\r\n        axios.post('/api/v1/users/login', state).then(res => {\r\n            let type = res.data.type;\r\n            if (type === 'success') {\r\n                if (res.data.token) {\r\n                    localStorage.setItem('wt', res.data.token)\r\n                }\r\n            } else {\r\n\r\n            }\r\n            setData({\r\n                ...data,\r\n                response: res.data.response,\r\n                type: res.data.type,\r\n            })\r\n\r\n        }).then(() => {\r\n            contextData.functions.getAndSetUserInfo();\r\n            contextData.functions.goToHomePage()\r\n        }).catch(err => console.log(err))\r\n    };\r\n\r\n\r\n    return (\r\n        <AppLayout>\r\n            <div className='Login authPage'>\r\n                <form className='authForm' onSubmit={ e => onSubmitHandler(e) }>\r\n                    <label className='messageLabel'>{ data.response }</label>\r\n                    <div className=\"authFormItem\">\r\n                        <p>username</p>\r\n                        <input name='username' onChange={ e => onChangeHandler(e) }/>\r\n                    </div>\r\n                    <div className=\"authFormItem\">\r\n                        <p>password</p>\r\n                        <input name='password' type='password' onChange={ e => onChangeHandler(e) }/>\r\n                    </div>\r\n                    <button className='submitBtn' type='submit'>Login</button>\r\n                </form>\r\n            </div>\r\n        </AppLayout>\r\n    );\r\n};\r\nexport default Login;"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AAAA;AAAA;AAAA;AACA;AADA;AAIA;AACA;AAFA;AAHA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AASA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAEA;AAAA;AACA;AACA;AACA;AACA;AACA;AAPA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AASA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AApBA;AARA;AAAA;AACA;AA8BA;AACA;AACA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAGA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAPA;AADA;AAeA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACxEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAAA;AAAA;AACA;AADA;AAKA;AACA;AAFA;AAJA;AAAA;AACA;AAQA;AACA;AAIA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAEA;AAEA;AACA;AAHA;AAMA;AACA;AACA;AACA;AAAA;AAAA;AACA;AACA;AAEA;AAEA;AAAA;AACA;AAAA;AAAA;AAAA;AAAA;AACA;AAAA;AACA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAEA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA;AAAA;AAAA;AAKA;AACA;AAAA;;;;A","sourceRoot":""}